<tool id="reditools_collection" name="REDItoolDnaRna with Collections" version="0.1.99">
  <description>for each sequence in a file</description>
  <command>
    <![CDATA[  
      #for $key in $input_1.keys()#

        python "$__tool_directory__/REDItoolDnaRna_wrapper.py"

        ## Input RNA-Seq BAM file
        -i $input_1[$key]

        ## Sort RNA-Seq
        #if str( $sort_1 ) == "true":
          -I
        #end if

        ## Reference file
        -f "${reference}"

        ## Output file
        -1 "$output[$key]"

        ## Set number of threads
        -t "\${GALAXY_SLOTS:-4}";

      #end for#
    ]]>
  </command>
 
  <inputs>
    <param name="input_1" type="data_collection" collection_type="list" label="Input" help="Input collection..." format="bam" />
    <param name="sort_1" type="boolean" truevalue="true" falsevalue="false" checked="False" label="Sort input RNA-Seq BAM file." />
    <param name="reference" format="fasta" type="data" label="Reference file in fasta format." help=" Note that each chromosome/region must be present in a single BAM file only."/>
  </inputs>
  <outputs>
    <collection name="output" type="list" label="Output List" structured_like="input_1" format="tabular" />
  </outputs>

  <tests>
    <test>
      <param name="input" value="rna.bam"/>
      <output name="out_file1" file="outTable" />
    </test>
  </tests>

  <stdio>
    <regex match="Pysam module not found."
           source="both"
           level="fatal"
           description="Pysam module not found" />

    <exit_code range="2" level="fatal" description="REDItools pid is not integer" />
    <exit_code range="3" level="fatal" description="Missing workding directory" />
  </stdio>         

  <help>
    This tool computes GC content from a FASTA file.
  </help>

</tool>

