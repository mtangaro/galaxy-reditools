<tool id="reditools_DnaRna_devel" name="REDItoolDnaRna-devel" version="0.1.99">
  <description>for each sequence in a file</description>
  <command interpreter="python">
    <![CDATA[  
    REDItoolDnaRna_wrapper.py 

      #if $library.type == "single" or $library.type == "single_collection"

        ## Input RNA-Seq BAM file
        -i "$library.input_1"

        ## Sort RNA-Seq
        #if str( $library.sort_1 ) == "true":
          -I
        #end if

      #elif $library.type == "paired"

        -i "$library.input_1"

        #if str( $library.sort_1 ) == "true":
          -I
        #end if

        ## DNA-Seq file
        -j "$library.input_2"

        ## Sort DNA-Seq
        #if str( $library.sort_2 ) == "true":
          -J
        #end if

      #end if

      ## Reference file
      -f "${reference}"

      ## Output file
      -1 "${output}"

      ## Set number of threads
      -t "\${GALAXY_SLOTS:-4}"

    ]]>
  </command>
 
  <inputs>
    <!-- single/paired -->
     <conditional name="library">
       <param name="type" type="select" label="Is this single or paired library">
         <option value="single">Single file</option>
         <option value="paired">Paired files</option>
         <option value="single_collection">Single Dataset Collection</option>
         <option value="paired_collection">Paired Dataset Collection</option>
       </param>

       <when value="single">
         <param name="input_1" format="bam" type="data" label="RNA-Seq BAM file."/>
         <param name="sort_1" type="boolean" truevalue="true" falsevalue="false" checked="False" label="Sort input RNA-Seq BAM file." />
       </when>

       <when value="paired">
         <param name="input_1" format="bam" type="data" label="RNA-Seq BAM file."/>
         <param name="sort_1" type="boolean" truevalue="true" falsevalue="false" checked="False" label="Sort input RNA-Seq BAM file." />
         <param name="input_2" format="bam" type="data" label="DNA-Seq BAM files separated by comma or folder containing BAM files." help=" Note that chromosome/region names in the reference must match chromosome/region names in BAMs files."/>
         <param name="sort_2" type="boolean" truevalue="true" falsevalue="false" checked="False" label="Sort input DNA-Seq BAM file." />
       </when>

       <when value="single_collection">
         <param name="input_1" format="bam" type="data_collection" collection_type="list" label="Sort input RNA-Seq BAM file." />
         <param name="sort_1" type="boolean" truevalue="true" falsevalue="false" checked="False" label="Sort input RNA-Seq BAM file." />
       </when>

    </conditional>

    <!-- reference genome -->
    <param name="reference" format="fasta" type="data" label="Reference file in fasta format." help=" Note that each chromosome/region must be present in a single BAM file only."/>

    <!-- read group settings -->

  </inputs>
  
  <outputs>
    <!-- data format="tabular" name="output" /-->
    <collection name="output" type="list" label="List"/>
  </outputs>

  <tests>
    <test>
      <param name="input" value="rna.bam"/>
      <output name="out_file1" file="outTable" />
    </test>
  </tests>

  <stdio>
    <regex match="Pysam module not found."
           source="both"
           level="fatal"
           description="Pysam module not found" />

    <exit_code range="2" level="fatal" description="REDItools pid is not integer" />
    <exit_code range="3" level="fatal" description="Missing workding directory" />
  </stdio>         

  <help>
    This tool computes GC content from a FASTA file.
  </help>

</tool>
